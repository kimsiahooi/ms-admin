import{d as L,z as P,c as h,x as S,j,m as k,a as c,o as m,e as r,u as t,g as F,w as n,b as d,f as T,i as v,h as p,t as y,F as $,v as z,q as A}from"./app-KSbgUuIU.js";import{u as O,_ as R,a as G,P as H}from"./MaterialSelect.vue_vue_type_script_setup_true_lang-Ck9vEjDQ.js";import{_ as V}from"./index-CYBbWwLu.js";import{_ as w}from"./Input.vue_vue_type_script_setup_true_lang-B4lqTRAY.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-BQ1of87h.js";import{_ as I,L as J}from"./Switch.vue_vue_type_script_setup_true_lang-m9ul1BKW.js";import{_ as K}from"./Textarea.vue_vue_type_script_setup_true_lang-ybfpBnld.js";import{u as Q,_ as W}from"./AppLayout.vue_vue_type_script_setup_true_lang-AZ2PnkQR.js";import{_ as X}from"./AppMainLayout.vue_vue_type_script_setup_true_lang-CmtaUbgQ.js";import{s as Y}from"./slug-xwoAxeGq.js";import"./Select.vue_vue_type_script_setup_true_lang-BILVJfgr.js";import"./RovingFocusGroup-CJwQLeDY.js";import"./useForwardExpose-BCGP6J9B.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-B0BTTmgX.js";import"./check-DTeDlD4X.js";import"./useFormControl-AaFHe1Yj.js";import"./VisuallyHiddenInput-CPNnyZE-.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CRRCczxj.js";import"./index-T6uICwUp.js";const Z={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},ee={class:"space-y-3"},te={class:"grid w-full items-center gap-1.5"},se={key:0,class:"text-destructive"},oe={class:"grid w-full items-center gap-1.5"},ae={key:0,class:"text-destructive"},ie={class:"grid w-full items-center gap-1.5"},re={key:0,class:"text-destructive"},le={class:"space-y-3"},de={class:"space-y-3"},ue={class:"flex items-center justify-center"},ne={class:"grid w-full items-center gap-1.5"},me={class:"flex items-center space-x-2"},pe={key:0,class:"text-destructive"},ce={class:"flex gap-2"},De=L({layout:X,__name:"Edit",props:{product:{},bom:{},materials:{},active_materials:{},options:{}},setup(U){const a=U,{tenant:l}=Q(),{uuid:b}=O(),C=[{title:"Dashboard",href:route("dashboard",{tenant:(l==null?void 0:l.id)||""})},{title:"Products",href:route("products.index",{tenant:(l==null?void 0:l.id)||""})},{title:a.product.name,href:"#"},{title:"Boms",href:route("products.boms.index",{tenant:(l==null?void 0:l.id)||"",product:a.product.id})},{title:a.bom.name,href:"#"},{title:"Edit",href:route("products.boms.edit",{tenant:(l==null?void 0:l.id)||"",product:a.product.id,bom:a.bom.id})}],x={data:null,quantity:"",unit_type:""},u=P(a.bom.materials.length?a.bom.materials.map(o=>{const e=a.active_materials.find(i=>i.id===o.id);return{key:b(),data:e||null,quantity:e?+o.pivot.quantity:"",unit_type:e?o.pivot.unit_type:""}}):[{...x,key:b()}]),E=h(()=>{var o;return(o=a.options.statuses.find(e=>s.status?e.value:!e.value))==null?void 0:o.name}),M=h(()=>a.active_materials.map(o=>({name:o.name,value:o}))),s=S({name:a.bom.name,code:a.bom.code,description:a.bom.description||"",materials:[],status:a.bom.status}),g=j({status:!!s.status}),q=()=>{u.value=[...u.value,{...x,key:b()}]},N=o=>{u.value=u.value.filter(e=>e.key!==o)},B=()=>s.put(route("products.boms.update",{tenant:(l==null?void 0:l.id)||"",product:a.product.id,bom:a.bom.id}));return k(u,o=>{s.materials=o.map(e=>{var i;return{key:e.key,id:((i=e.data)==null?void 0:i.id)||"",quantity:e.quantity,unit_type:e.unit_type}})},{immediate:!0,deep:!0}),k(()=>s.name,o=>{s.code=Y(o)}),k(()=>g.status,o=>{var i;const e=(i=a.options.statuses.find(_=>o?_.value===1:_.value===0))==null?void 0:i.value;e!==void 0&&(s.status=e)}),(o,e)=>(m(),c($,null,[r(t(F),{title:`Edit ${a.bom.name}`},null,8,["title"]),r(W,{breadcrumbs:C},{default:n(()=>[d("div",Z,[d("div",ee,[d("form",{onSubmit:T(B,["prevent"]),class:"space-y-4"},[d("div",te,[r(t(f),null,{default:n(()=>e[4]||(e[4]=[p("Name")])),_:1,__:[4]}),r(t(w),{type:"text",placeholder:"Enter Name","model-value":t(s).name,"onUpdate:modelValue":e[0]||(e[0]=i=>t(s).name=i)},null,8,["model-value"]),t(s).errors.name?(m(),c("p",se,y(t(s).errors.name),1)):v("",!0)]),d("div",oe,[r(t(f),null,{default:n(()=>e[5]||(e[5]=[p("Code")])),_:1,__:[5]}),r(t(w),{type:"text",placeholder:"Enter Code","model-value":t(s).code,"onUpdate:modelValue":e[1]||(e[1]=i=>t(s).code=i)},null,8,["model-value"]),t(s).errors.code?(m(),c("p",ae,y(t(s).errors.code),1)):v("",!0)]),d("div",ie,[r(t(f),null,{default:n(()=>e[6]||(e[6]=[p("Description")])),_:1,__:[6]}),r(t(K),{placeholder:"Enter Description","model-value":t(s).description,"onUpdate:modelValue":e[2]||(e[2]=i=>t(s).description=i)},null,8,["model-value"]),t(s).errors.description?(m(),c("p",re,y(t(s).errors.description),1)):v("",!0)]),d("div",le,[d("div",null,[r(t(f),{class:"mb-1"},{default:n(()=>e[7]||(e[7]=[p("Materials")])),_:1,__:[7]})]),d("div",de,[(m(!0),c($,null,z(u.value,(i,_)=>(m(),c("div",{key:i.key,class:"space-y-1"},[r(t(R),{"material-options":M.value,"unit-type-options":o.options.unit_types,"total-selected":u.value.length,"model-value":u.value[_],"onUpdate:modelValue":D=>u.value[_]=D,onRemove:N},null,8,["material-options","unit-type-options","total-selected","model-value","onUpdate:modelValue"]),r(t(G),{"error-key":`materials.${_}`},null,8,["error-key"])]))),128))]),d("div",ue,[r(t(V),{type:"button",class:"cursor-pointer",variant:"outline",onClick:q},{default:n(()=>[r(t(H)),e[8]||(e[8]=p(" Add Material"))]),_:1,__:[8]})])]),d("div",ne,[r(t(f),{class:"mb-1"},{default:n(()=>e[9]||(e[9]=[p("Status")])),_:1,__:[9]}),d("div",me,[r(t(I),{class:"cursor-pointer","model-value":g.status,"onUpdate:modelValue":e[3]||(e[3]=i=>g.status=i)},null,8,["model-value"]),r(t(f),null,{default:n(()=>[p(y(E.value),1)]),_:1})]),t(s).errors.status?(m(),c("p",pe,y(t(s).errors.status),1)):v("",!0)]),d("div",ce,[r(t(V),{type:"submit",class:"cursor-pointer",disabled:t(s).processing},{default:n(()=>[t(s).processing?(m(),A(t(J),{key:0,class:"animate-spin"})):v("",!0),e[10]||(e[10]=p(" Update "))]),_:1,__:[10]},8,["disabled"])])],32)])])]),_:1})],64))}});export{De as default};
