import{d as h,c,x as w,a as f,o as u,e as r,u as e,g as D,w as d,b as n,f as E,h as k,i as x,q as b,F as y,v as B}from"./app-DW3qUSpG.js";import{_ as L}from"./Card.vue_vue_type_script_setup_true_lang-DZHqgzGk.js";import{L as A}from"./index-Bi-HJBVM.js";import{_ as F}from"./FormError.vue_vue_type_script_setup_true_lang-1af55uzd.js";import{_ as I}from"./index-CgwL-eGe.js";import{_ as P}from"./Label.vue_vue_type_script_setup_true_lang-Mfd-XF4S.js";import{_ as V}from"./FormInput.vue_vue_type_script_setup_true_lang-Btfx0rSq.js";import{_ as R}from"./FormSwitch.vue_vue_type_script_setup_true_lang-zC1jdb_M.js";import{_ as j}from"./FormTextarea.vue_vue_type_script_setup_true_lang-V-SYeW4h.js";import{S as q,a as M,_ as z}from"./index-CU-F_MNW.js";import{u as G,_ as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-BgvfEKRj.js";import{u as J,P as K}from"./useUuid-BVk90Rr7.js";import{_ as O}from"./AppMainLayout.vue_vue_type_script_setup_true_lang-o02Mcb03.js";import"./useForwardExpose-CvcD0Rb6.js";import"./Input.vue_vue_type_script_setup_true_lang-JOJUwJ_8.js";import"./Switch.vue_vue_type_script_setup_true_lang-C_KlnxJK.js";import"./RovingFocusGroup-RdfVjWf9.js";import"./useFormControl-D4ksLBo0.js";import"./VisuallyHiddenInput-ChKgx7vy.js";import"./FormCombobox.vue_vue_type_script_setup_true_lang-D8IKo5CC.js";import"./check-CxD0QyHG.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-vj4ZpyyN.js";import"./chevron-down-MWTkW-nX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DsKetNlE.js";const Q={class:"space-y-3"},W={class:"space-y-3"},X={class:"flex items-center justify-center"},ge=h({layout:O,__name:"Edit",props:{route:{},plants:{},options:{}},setup($){const l=$,{tenant:a}=G(),{uuid:m}=J(),g=c(()=>[{title:"Dashboard",href:route("dashboard",{tenant:(a==null?void 0:a.id)||""})},{title:"Routes",href:route("routes.index",{tenant:(a==null?void 0:a.id)||""})},{title:l.route.name,href:"#"},{title:"Edit",href:route("routes.edit",{tenant:(a==null?void 0:a.id)||"",route:l.route.id})}]),U=c(()=>{var s;return((s=l.options.switch.statuses.find(o=>o.value===t.status))==null?void 0:s.name)??q[M.INACTIVE]}),_=c(()=>l.route.tasks.filter(s=>{var o;return(o=s.operation)==null?void 0:o.plant}).map(s=>{var o;return{key:m(),plant_id:((o=s.operation)==null?void 0:o.plant_id)??void 0,operation_id:s.operation_id??void 0,task_id:s.id}})),v={plant_id:"",operation_id:"",task_id:""},t=w({name:l.route.name,code:l.route.code,description:l.route.description??void 0,status:l.route.status.switch??void 0,tasks:_.value.length?_.value:[{key:m(),...v}]}),T=()=>t.put(route("routes.update",{tenant:(a==null?void 0:a.id)||"",route:l.route.id}),{preserveScroll:!0,preserveState:!0}),C=()=>{t.tasks=[...t.tasks,{key:m(),...v}]},N=s=>{t.tasks=t.tasks.filter(o=>o.key!==s)};return(s,o)=>(u(),f(y,null,[r(e(D),{title:s.route.name},null,8,["title"]),r(H,{breadcrumbs:g.value},{default:d(()=>[r(e(A),null,{default:d(()=>[n("form",{onSubmit:E(T,["prevent"])},[r(e(L),{title:`Edit ${s.route.name}`},{default:d(()=>[r(e(V),{label:"Name",error:e(t).errors.name,"model-value":e(t).name,"onUpdate:modelValue":o[0]||(o[0]=i=>e(t).name=i)},null,8,["error","model-value"]),r(e(V),{label:"Code",error:e(t).errors.code,"model-value":e(t).code,"onUpdate:modelValue":o[1]||(o[1]=i=>e(t).code=i)},null,8,["error","model-value"]),r(e(j),{label:"Description",error:e(t).errors.description,"model-value":e(t).description,"onUpdate:modelValue":o[2]||(o[2]=i=>e(t).description=i)},null,8,["error","model-value"]),n("div",Q,[n("div",null,[r(e(P),{class:"mb-1"},{default:d(()=>o[4]||(o[4]=[b("Tasks:")])),_:1,__:[4]})]),n("div",W,[(u(!0),f(y,null,B(e(t).tasks,(i,p)=>(u(),f("div",{key:i.key,class:"space-y-1"},[(u(),k(e(z),{key:i.key,plants:s.plants,"total-selected":e(t).tasks.length,"curr-index":p,"model-value":e(t).tasks[p],"onUpdate:modelValue":S=>e(t).tasks[p]=S,onRemove:N},null,8,["plants","total-selected","curr-index","model-value","onUpdate:modelValue"]))]))),128))]),n("div",X,[r(e(I),{type:"button",class:"cursor-pointer",variant:"outline",onClick:C},{default:d(()=>[r(e(K)),o[5]||(o[5]=b(" Add Task"))]),_:1,__:[5]})])]),e(t).status!==void 0?(u(),k(e(R),{key:0,label:U.value,error:e(t).errors.status,"model-value":e(t).status,"onUpdate:modelValue":o[3]||(o[3]=i=>e(t).status=i)},null,8,["label","error","model-value"])):x("",!0),r(e(F),{type:"submit",disabled:e(t).processing,label:"Update",loading:e(t).processing},null,8,["disabled","loading"])]),_:1},8,["title"])],32)]),_:1})]),_:1},8,["breadcrumbs"])],64))}});export{ge as default};
