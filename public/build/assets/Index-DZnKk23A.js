import{d as U,c as n,x as b,r as C,j as K,a as O,o as N,e as l,u as o,g as P,w as m,b as c,W as T,f as k,k as a,l as L,F as E}from"./app-BgTXa90_.js";import{_ as F,a as R,b as j}from"./StatusSwitch.vue_vue_type_script_setup_true_lang-BZcE18FL.js";import{_ as W,a as M,b as q,e as z,p as G,c as h,P as H,d as J,T as Q,u as X}from"./pickBy-2vWdj-xt.js";import{L as Y}from"./index-BvCIcig5.js";import{_ as Z}from"./FormError.vue_vue_type_script_setup_true_lang-BVg2IwEG.js";import{_ as g}from"./FormCombobox.vue_vue_type_script_setup_true_lang-C_d6RY7a.js";import{_ as ee}from"./FormSwitch.vue_vue_type_script_setup_true_lang-D0NXErWG.js";import{_ as te}from"./Dialog.vue_vue_type_script_setup_true_lang-DeXI2Vk1.js";import{u as oe,_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-CdHOQRKV.js";import{_ as ae}from"./AppMainLayout.vue_vue_type_script_setup_true_lang-k-gsNc47.js";import{S as re,a as ie}from"./index-BWts5uV5.js";import"./index-gvFlOA9A.js";import"./useForwardExpose-rU1I-y_0.js";import"./Label.vue_vue_type_script_setup_true_lang-DfAzriwx.js";import"./Select.vue_vue_type_script_setup_true_lang-1hEi5SeN.js";import"./RovingFocusGroup-Cq5P6bq-.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-COVDtZ7L.js";import"./check-DnxLo8EA.js";import"./useFormControl-D4E9fVKJ.js";import"./nullish-CHIgUVhi.js";import"./chevron-down-53sWXJgT.js";import"./Switch.vue_vue_type_script_setup_true_lang-C_f7LROW.js";import"./VisuallyHiddenInput-DKmQAXjO.js";import"./Input.vue_vue_type_script_setup_true_lang-CoLfU2BV.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-DmsPglon.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-a7lEFZeV.js";const le={class:"space-y-3"},ue={class:"flex flex-wrap items-center justify-end gap-2"},Pe=U({layout:ae,__name:"Index",props:{route:{},boms:{},products:{},options:{}},setup(y){const u=y,{tenant:s}=oe(),{formatDateTime:_}=X(),p=n(()=>route().params),d=b({search:p.value.search,entries:p.value.entries||"10",status:p.value.status}),f=C({create:{dialogIsOpen:!1}}),S=n(()=>[{title:"Dashboard",href:route("dashboard",{tenant:(s==null?void 0:s.id)||""})},{title:"Routes",href:route("routes.index",{tenant:(s==null?void 0:s.id)||""})},{title:u.route.name,href:"#"},{title:"Boms",href:route("routes.boms.index",{tenant:(s==null?void 0:s.id)||"",route:u.route.id})}]),$=n(()=>u.products.map(t=>({name:t.name,value:t.id}))),x=n(()=>{var t;return((t=u.products.find(e=>e.id===r.product_id))==null?void 0:t.boms.map(e=>({name:e.name,value:e.id})))??[]}),v=()=>T.visit(route("routes.boms.index",{...G(d.data()),tenant:(s==null?void 0:s.id)||"",route:u.route.id}),{preserveScroll:!0,preserveState:!0}),V=()=>{d.reset(),v()},B=[{accessorKey:"actions",header:()=>a("div",null,"Actions"),cell:({row:t})=>{const e=t.original;return a("div",{class:"flex items-center gap-2"},[a(R,{value:e.pivot.status.switch,method:"put",href:route("routes.boms.toggleStatus",{tenant:(s==null?void 0:s.id)||"",route:u.route.id,bom:e.pivot.id})}),a(h,{text:"Edit",href:route("routes.boms.edit",{tenant:(s==null?void 0:s.id)||"",route:u.route.id,bom:e.pivot.id}),icon:H}),a(J,{title:`Detach ${e.name}`,route:route("routes.boms.destroy",{tenant:(s==null?void 0:s.id)||"",route:u.route.id,bom:e.pivot.id}),description:"Are you sure you want to detach?",buttonLabel:"Detach",asChild:!1},()=>a(h,{variant:"destructive",text:"Detach",icon:Q}))])}},{accessorKey:"status",header:()=>a("div",null,"Status"),cell:({row:t})=>{const{pivot:e}=t.original;return a(j,{statusBadge:e.status.badge})}},{accessorKey:"id",header:()=>a("div",null,"Id"),cell:({row:t})=>a("div",null,t.getValue("id"))},{accessorKey:"name",header:()=>a("div",null,"Name"),cell:({row:t})=>{const{name:e}=t.original;return a("div",null,e)}},{accessorKey:"code",header:()=>a("div",null,"Code"),cell:({row:t})=>{const{code:e}=t.original;return a("div",null,e)}},{accessorKey:"created_at",header:()=>a("div",null,"Created At"),cell:({row:t})=>{const{pivot:e}=t.original;return a("div",null,_(e.created_at)||"")}},{accessorKey:"updated_at",header:()=>a("div",null,"Updated At"),cell:({row:t})=>{const{pivot:e}=t.original;return a("div",null,_(e.updated_at)||"")}}],w={id:!1},I=n(()=>{var t;return!!((t=u.options.switch.statuses.find(e=>e.is_default))!=null&&t.value)}),A=n(()=>{var t;return((t=u.options.switch.statuses.find(e=>e.value===r.status))==null?void 0:t.name)??re[ie.INACTIVE]}),r=b({product_id:"",bom_id:"",status:I.value}),D=()=>r.post(route("routes.boms.store",{tenant:(s==null?void 0:s.id)||"",route:u.route.id}),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{r.reset(),f.create.dialogIsOpen=!1}});return K(()=>r.product_id,()=>{r.bom_id=""}),(t,e)=>(N(),O(E,null,[l(o(P),{title:"Boms"}),l(se,{breadcrumbs:S.value},{default:m(()=>[l(o(Y),null,{default:m(()=>[c("div",le,[l(o(W),{onSearch:v,onReset:V},{default:m(()=>[l(o(M),{label:"Name",placeholder:"Search ID, Name, Code","model-value":o(d).search,"onUpdate:modelValue":e[0]||(e[0]=i=>o(d).search=i)},null,8,["model-value"]),l(o(F),{label:"Status",placeholder:"Select Status",options:t.options.select.statuses,"model-value":o(d).status,"onUpdate:modelValue":e[1]||(e[1]=i=>o(d).status=i),multiple:""},null,8,["options","model-value"])]),_:1}),c("div",ue,[l(o(te),{title:"Attach Product Bom",open:f.create.dialogIsOpen,"onUpdate:open":e[5]||(e[5]=i=>f.create.dialogIsOpen=i),"trigger-label":"Attach"},{default:m(()=>[c("form",{onSubmit:k(D,["prevent"]),class:"space-y-4"},[l(o(g),{options:$.value,placeholder:"Select Product",label:"Product","model-value":o(r).product_id,"onUpdate:modelValue":e[2]||(e[2]=i=>o(r).product_id=i),error:o(r).errors.product_id},null,8,["options","model-value","error"]),l(o(g),{options:x.value,placeholder:"Select Bom",label:"Bom","model-value":o(r).bom_id,"onUpdate:modelValue":e[3]||(e[3]=i=>o(r).bom_id=i),error:o(r).errors.bom_id},null,8,["options","model-value","error"]),l(o(ee),{label:A.value,error:o(r).errors.status,"model-value":o(r).status,"onUpdate:modelValue":e[4]||(e[4]=i=>o(r).status=i)},null,8,["label","error","model-value"]),l(o(Z),{type:"submit",label:"Attach",disabled:o(r).processing,loading:o(r).processing},null,8,["disabled","loading"])],32)]),_:1},8,["open"])]),c("div",null,[l(o(q),{"model-value":o(d),"onUpdate:modelValue":e[6]||(e[6]=i=>L(d)?d.value=i:null),columns:B,"paginate-data":t.boms,"column-visibility":w,"entry-options":o(z),onSearch:v},null,8,["model-value","paginate-data","entry-options"])])])]),_:1})]),_:1},8,["breadcrumbs"])],64))}});export{Pe as default};
