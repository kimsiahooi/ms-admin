import{d as N,c as y,r as b,x as w,f as V,a as O,o as k,e as i,u as s,g as F,w as c,b as m,W as S,h as L,i as r,F as P}from"./app-Bpp2Ep_u.js";import{_ as W,a as j,b as M}from"./StatusSwitch.vue_vue_type_script_setup_true_lang-W1CIgrju.js";import{_ as R,a as q,b as z,e as G,p as H,c as $,P as J,d as Q,T as X,u as Y}from"./pickBy-V1SMm1A7.js";import{L as Z}from"./index-DfOI-09q.js";import{_ as C,a as ee}from"./FormInput.vue_vue_type_script_setup_true_lang-DpYkQWZj.js";import{_ as ae}from"./FormSwitch.vue_vue_type_script_setup_true_lang-rNDFlZ_x.js";import{_ as I}from"./FormTextarea.vue_vue_type_script_setup_true_lang-BptgrTO4.js";import{_ as se}from"./Dialog.vue_vue_type_script_setup_true_lang-CNkUMidd.js";import{u as te,_ as oe}from"./AppLayout.vue_vue_type_script_setup_true_lang-BF1Gl5Ph.js";import{_ as re}from"./AppMainLayout.vue_vue_type_script_setup_true_lang-ByRRqFff.js";import{a as u,S as le}from"./index-BVEeh8sU.js";import{s as ie}from"./slug-xwoAxeGq.js";import"./index-C6fWEfII.js";import"./useForwardExpose-rOcx7BkQ.js";import"./Label.vue_vue_type_script_setup_true_lang-xwMa4j3f.js";import"./Select.vue_vue_type_script_setup_true_lang-qBXRkwJR.js";import"./RovingFocusGroup-bXShlB3H.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-OVzfARf1.js";import"./check-Bw0EwC7w.js";import"./useFormControl-a5l-P2b3.js";import"./Switch.vue_vue_type_script_setup_true_lang-BA_0ISoO.js";import"./VisuallyHiddenInput-CCj47bq6.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-CWyXmvF6.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-DHlMUJZx.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-D4rF7PW5.js";const ne={class:"space-y-3"},de={class:"flex flex-wrap items-center justify-end gap-2"},we=N({layout:re,__name:"Index",props:{company:{},branches:{},options:{}},setup(x){const n=x,{tenant:t}=te(),{formatDateTime:h}=Y(),p=y(()=>route().params),d=b({search:p.value.search,entries:p.value.entries||"10",status:p.value.status}),f=b({create:{dialogIsOpen:!1}}),A=[{title:"Dashboard",href:route("dashboard",{tenant:(t==null?void 0:t.id)||""})},{title:"Companies",href:route("companies.index",{tenant:(t==null?void 0:t.id)||""})},{title:n.company.name,href:"#"},{title:"Branches",href:route("companies.branches.index",{tenant:(t==null?void 0:t.id)||"",company:n.company.id})}],_=()=>S.visit(route("companies.branches.index",{...H(d),tenant:(t==null?void 0:t.id)||"",company:n.company.id}),{preserveScroll:!0,preserveState:!0}),T=()=>S.visit(route("companies.branches.index",{tenant:(t==null?void 0:t.id)||"",company:n.company.id})),U={id:!1,description:!1,address:!1},D=[{accessorKey:"actions",header:()=>r("div",null,"Actions"),cell:({row:a})=>{const e=a.original;return r("div",{class:"flex items-center gap-2"},[r(j,{value:e.status.switch,method:"put",href:route("companies.branches.toggleStatus",{tenant:(t==null?void 0:t.id)||"",company:n.company.id,branch:e.id})}),r($,{text:"Edit",href:route("companies.branches.edit",{tenant:(t==null?void 0:t.id)||"",company:n.company.id,branch:e.id}),icon:J}),r(Q,{title:`Delete ${e.name}`,route:route("companies.branches.destroy",{tenant:(t==null?void 0:t.id)||"",company:n.company.id,branch:e.id}),asChild:!1},()=>r($,{variant:"destructive",text:"Delete",icon:X}))])}},{accessorKey:"status",header:()=>r("div",null,"Status"),cell:({row:a})=>{const{status:e}=a.original;return r(M,{statusBadge:e.badge})}},{accessorKey:"id",header:()=>r("div",null,"Id"),cell:({row:a})=>r("div",null,a.getValue("id"))},{accessorKey:"name",header:()=>r("div",null,"Name"),cell:({row:a})=>r("div",null,a.getValue("name"))},{accessorKey:"code",header:()=>r("div",null,"Code"),cell:({row:a})=>r("div",null,a.getValue("code"))},{accessorKey:"description",header:()=>r("div",null,"Description"),cell:({row:a})=>r("div",null,a.getValue("description"))},{accessorKey:"address",header:()=>r("div",null,"Address"),cell:({row:a})=>r("div",null,a.getValue("address"))},{accessorKey:"created_at",header:()=>r("div",null,"Created At"),cell:({row:a})=>r("div",null,h(a.getValue("created_at"))||"")},{accessorKey:"updated_at",header:()=>r("div",null,"Updated At"),cell:({row:a})=>r("div",null,h(a.getValue("updated_at"))||"")}],K=y(()=>{var a;return((a=n.options.statuses.find(e=>e.is_default))==null?void 0:a.value)??u.ACTIVE}),B=y(()=>{var a;return((a=n.options.statuses.find(e=>e.value===o.status))==null?void 0:a.name)??le[u.ACTIVE]}),o=w({name:"",code:"",description:"",address:"",status:K.value}),v=b({status:o.status===u.ACTIVE}),E=()=>o.post(route("companies.branches.store",{tenant:(t==null?void 0:t.id)||"",company:n.company.id}),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{o.reset(),f.create.dialogIsOpen=!1}});return V(()=>o.name,a=>{o.code=ie(a)}),V(()=>v.status,a=>{var l;const e=(l=n.options.statuses.find(g=>a?g.value===u.ACTIVE:g.value===u.INACTIVE))==null?void 0:l.value;e!==void 0&&(o.status=e)}),(a,e)=>(k(),O(P,null,[i(s(F),{title:"Company Branches"}),i(oe,{breadcrumbs:A},{default:c(()=>[i(s(Z),null,{default:c(()=>[m("div",ne,[i(s(R),{onSearch:_,onReset:T},{default:c(()=>[i(s(q),{label:"Name",placeholder:"Search ID, Name, Code","model-value":d.search,"onUpdate:modelValue":e[0]||(e[0]=l=>d.search=l)},null,8,["model-value"]),i(s(W),{label:"Status",placeholder:"Select Status",options:a.options.statuses,multiple:"","model-value":d.status,"onUpdate:modelValue":e[1]||(e[1]=l=>d.status=l)},null,8,["options","model-value"])]),_:1}),m("div",de,[i(s(se),{title:"Create Branch",open:f.create.dialogIsOpen,"onUpdate:open":e[7]||(e[7]=l=>f.create.dialogIsOpen=l)},{default:c(()=>[m("form",{onSubmit:L(E,["prevent"]),class:"space-y-4"},[i(s(C),{label:"Name",error:s(o).errors.name,"model-value":s(o).name,"onUpdate:modelValue":e[2]||(e[2]=l=>s(o).name=l)},null,8,["error","model-value"]),i(s(C),{label:"Code",error:s(o).errors.code,"model-value":s(o).code,"onUpdate:modelValue":e[3]||(e[3]=l=>s(o).code=l)},null,8,["error","model-value"]),i(s(I),{label:"Description",error:s(o).errors.description,"model-value":s(o).description,"onUpdate:modelValue":e[4]||(e[4]=l=>s(o).description=l)},null,8,["error","model-value"]),i(s(I),{label:"Address",error:s(o).errors.address,"model-value":s(o).address,"onUpdate:modelValue":e[5]||(e[5]=l=>s(o).address=l)},null,8,["error","model-value"]),i(s(ae),{label:B.value,error:s(o).errors.status,"model-value":v.status,"onUpdate:modelValue":e[6]||(e[6]=l=>v.status=l)},null,8,["label","error","model-value"]),i(s(ee),{type:"submit",disabled:s(o).processing,loading:s(o).processing},null,8,["disabled","loading"])],32)]),_:1},8,["open"])]),m("div",null,[i(s(z),{"model-value":d,"onUpdate:modelValue":e[8]||(e[8]=l=>d=l),columns:D,"paginate-data":a.branches,"column-visibility":U,"entry-options":s(G),onSearch:_},null,8,["model-value","paginate-data","entry-options"])])])]),_:1})]),_:1})],64))}});export{we as default};
