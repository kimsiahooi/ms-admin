import{d as q,z as A,c as V,x as I,r as N,f as v,a as _,o as b,e as l,u as t,g as w,w as m,b as n,h as B,n as g,F as k,s as L}from"./app-Bpp2Ep_u.js";import{L as D}from"./index-DfOI-09q.js";import{_ as $,a as P}from"./FormInput.vue_vue_type_script_setup_true_lang-DpYkQWZj.js";import{_ as F}from"./Label.vue_vue_type_script_setup_true_lang-xwMa4j3f.js";import{_ as j}from"./FormSwitch.vue_vue_type_script_setup_true_lang-rNDFlZ_x.js";import{_ as z}from"./FormTextarea.vue_vue_type_script_setup_true_lang-BptgrTO4.js";import{_ as O}from"./index-C6fWEfII.js";import{u as R,a as G,S as p,_ as H,P as J}from"./index-4uiBMSfV.js";import{u as K,_ as Q}from"./AppLayout.vue_vue_type_script_setup_true_lang-BF1Gl5Ph.js";import{_ as W}from"./AppMainLayout.vue_vue_type_script_setup_true_lang-ByRRqFff.js";import{s as X}from"./slug-xwoAxeGq.js";import"./useForwardExpose-rOcx7BkQ.js";import"./Switch.vue_vue_type_script_setup_true_lang-BA_0ISoO.js";import"./RovingFocusGroup-bXShlB3H.js";import"./useFormControl-a5l-P2b3.js";import"./VisuallyHiddenInput-CCj47bq6.js";import"./FormSelect.vue_vue_type_script_setup_true_lang-DS1JOaSZ.js";import"./Select.vue_vue_type_script_setup_true_lang-qBXRkwJR.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-OVzfARf1.js";import"./check-Bw0EwC7w.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-D4rF7PW5.js";const Y={class:"space-y-3"},Z={class:"space-y-3"},ee={class:"space-y-3"},te={class:"flex items-center justify-center"},Ce=q({layout:W,__name:"Edit",props:{product:{},bom:{},materials:{},options:{}},setup(C){const s=C,{tenant:r}=K(),{uuid:c}=R(),E=[{title:"Dashboard",href:route("dashboard",{tenant:(r==null?void 0:r.id)||""})},{title:"Products",href:route("products.index",{tenant:(r==null?void 0:r.id)||""})},{title:s.product.name,href:"#"},{title:"Boms",href:route("products.boms.index",{tenant:(r==null?void 0:r.id)||"",product:s.product.id})},{title:s.bom.name,href:"#"},{title:"Edit",href:route("products.boms.edit",{tenant:(r==null?void 0:r.id)||"",product:s.product.id,bom:s.bom.id})}],y={data:null,quantity:"",unit_type:""},u=A(s.bom.materials.length?s.bom.materials.map(a=>({key:c(),data:a,quantity:+a.pivot.quantity,unit_type:a.pivot.unit_type})):[{...y,key:c()}]),U=V(()=>{var a;return((a=s.options.statuses.find(e=>e.value===o.status))==null?void 0:a.name)??G[p.ACTIVE]}),h=V(()=>s.materials.map(a=>({name:a.name,value:a}))),o=I({name:s.bom.name,code:s.bom.code,description:s.bom.description||"",materials:[],status:s.bom.status.value}),f=N({status:o.status===p.ACTIVE}),x=()=>{u.value=[...u.value,{...y,key:c()}]},M=a=>{u.value=u.value.filter(e=>e.key!==a)},S=()=>o.put(route("products.boms.update",{tenant:(r==null?void 0:r.id)||"",product:s.product.id,bom:s.bom.id}),{preserveScroll:!0,preserveState:!0});return v(u,a=>{o.materials=a.map(e=>{var i;return{key:e.key,id:((i=e.data)==null?void 0:i.id)||"",quantity:e.quantity,unit_type:e.unit_type}})},{immediate:!0,deep:!0}),v(()=>o.name,a=>{o.code=X(a)}),v(()=>f.status,a=>{var i;const e=(i=s.options.statuses.find(d=>a?d.value===p.ACTIVE:d.value===p.INACTIVE))==null?void 0:i.value;e!==void 0&&(o.status=e)}),(a,e)=>(b(),_(k,null,[l(t(w),{title:`Edit ${s.bom.name}`},null,8,["title"]),l(Q,{breadcrumbs:E},{default:m(()=>[l(t(D),null,{default:m(()=>[n("div",Y,[n("form",{onSubmit:B(S,["prevent"]),class:"space-y-4"},[l(t($),{label:"Name",error:t(o).errors.name,"model-value":t(o).name,"onUpdate:modelValue":e[0]||(e[0]=i=>t(o).name=i)},null,8,["error","model-value"]),l(t($),{label:"Code",error:t(o).errors.code,"model-value":t(o).code,"onUpdate:modelValue":e[1]||(e[1]=i=>t(o).code=i)},null,8,["error","model-value"]),l(t(z),{label:"Description",error:t(o).errors.description,"model-value":t(o).description,"onUpdate:modelValue":e[2]||(e[2]=i=>t(o).description=i)},null,8,["error","model-value"]),n("div",Z,[n("div",null,[l(t(F),{class:"mb-1"},{default:m(()=>e[4]||(e[4]=[g("Materials:")])),_:1,__:[4]})]),n("div",ee,[(b(!0),_(k,null,L(u.value,(i,d)=>(b(),_("div",{key:i.key,class:"space-y-1"},[l(t(H),{"material-options":h.value,"unit-type-options":a.options.unit_types,"total-selected":u.value.length,"model-value":u.value[d],"onUpdate:modelValue":T=>u.value[d]=T,"curr-index":d,onRemove:M},null,8,["material-options","unit-type-options","total-selected","model-value","onUpdate:modelValue","curr-index"])]))),128))]),n("div",te,[l(t(O),{type:"button",class:"cursor-pointer",variant:"outline",onClick:x},{default:m(()=>[l(t(J)),e[5]||(e[5]=g(" Add Material"))]),_:1,__:[5]})])]),l(t(j),{label:U.value,error:t(o).errors.status,"model-value":f.status,"onUpdate:modelValue":e[3]||(e[3]=i=>f.status=i)},null,8,["label","error","model-value"]),l(t(P),{type:"submit",label:"Update",disabled:t(o).processing,loading:t(o).processing},null,8,["disabled","loading"])],32)])]),_:1})]),_:1})],64))}});export{Ce as default};
