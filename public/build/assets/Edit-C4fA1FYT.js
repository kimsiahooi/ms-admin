import{d as w,c,x as D,a as f,o as n,e as s,u as e,g as E,w as d,b as u,f as x,h as b,i as B,q as y,F as k,v as L}from"./app-BgTXa90_.js";import{_ as O}from"./Card.vue_vue_type_script_setup_true_lang-CNAuYvQV.js";import{L as R}from"./index-BvCIcig5.js";import{_ as T}from"./FormError.vue_vue_type_script_setup_true_lang-BVg2IwEG.js";import{_ as A}from"./index-gvFlOA9A.js";import{_ as F}from"./Label.vue_vue_type_script_setup_true_lang-DfAzriwx.js";import{_ as V}from"./FormInput.vue_vue_type_script_setup_true_lang-Bcig7n-I.js";import{_ as I}from"./FormSwitch.vue_vue_type_script_setup_true_lang-D0NXErWG.js";import{_ as P}from"./FormTextarea.vue_vue_type_script_setup_true_lang-S96odKLP.js";import{S as j,a as q,_ as M}from"./index-C8JToDkk.js";import{u as z,_ as G}from"./AppLayout.vue_vue_type_script_setup_true_lang-CdHOQRKV.js";import{u as H,P as J}from"./useUuid-rYsxxeMQ.js";import{_ as K}from"./AppMainLayout.vue_vue_type_script_setup_true_lang-k-gsNc47.js";import"./useForwardExpose-rU1I-y_0.js";import"./Input.vue_vue_type_script_setup_true_lang-CoLfU2BV.js";import"./Switch.vue_vue_type_script_setup_true_lang-C_f7LROW.js";import"./RovingFocusGroup-Cq5P6bq-.js";import"./useFormControl-D4E9fVKJ.js";import"./VisuallyHiddenInput-DKmQAXjO.js";import"./FormCombobox.vue_vue_type_script_setup_true_lang-C_d6RY7a.js";import"./check-DnxLo8EA.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-COVDtZ7L.js";import"./chevron-down-53sWXJgT.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-a7lEFZeV.js";const Q={class:"space-y-3"},W={class:"space-y-3"},X={class:"flex items-center justify-center"},ge=w({layout:K,__name:"Edit",props:{route:{},plants:{},options:{}},setup($){const l=$,{tenant:a}=z(),{uuid:m}=H(),g=c(()=>[{title:"Dashboard",href:route("dashboard",{tenant:(a==null?void 0:a.id)||""})},{title:"Routes",href:route("routes.index",{tenant:(a==null?void 0:a.id)||""})},{title:l.route.name,href:"#"},{title:"Edit",href:route("routes.edit",{tenant:(a==null?void 0:a.id)||"",route:l.route.id})}]),U=c(()=>{var r;return((r=l.options.switch.statuses.find(o=>o.value===t.status))==null?void 0:r.name)??j[q.INACTIVE]}),_=c(()=>l.route.operations.filter(r=>{var o;return(o=r.department)==null?void 0:o.plant}).map(r=>{var o;return{key:m(),plant_id:((o=r.department)==null?void 0:o.plant_id)??void 0,department_id:r.department_id??void 0,operation_id:r.id}})),v={plant_id:"",department_id:"",operation_id:""},t=D({name:l.route.name,code:l.route.code,description:l.route.description??void 0,status:l.route.status.switch??void 0,operations:_.value.length?_.value:[{key:m(),...v}]}),C=()=>t.put(route("routes.update",{tenant:(a==null?void 0:a.id)||"",route:l.route.id}),{preserveScroll:!0,preserveState:!0}),N=()=>{t.operations=[...t.operations,{key:m(),...v}]},S=r=>{t.operations=t.operations.filter(o=>o.key!==r)};return(r,o)=>(n(),f(k,null,[s(e(E),{title:r.route.name},null,8,["title"]),s(G,{breadcrumbs:g.value},{default:d(()=>[s(e(R),null,{default:d(()=>[u("form",{onSubmit:x(C,["prevent"])},[s(e(O),{title:`Edit ${r.route.name}`},{default:d(()=>[s(e(V),{label:"Name",error:e(t).errors.name,"model-value":e(t).name,"onUpdate:modelValue":o[0]||(o[0]=i=>e(t).name=i)},null,8,["error","model-value"]),s(e(V),{label:"Code",error:e(t).errors.code,"model-value":e(t).code,"onUpdate:modelValue":o[1]||(o[1]=i=>e(t).code=i)},null,8,["error","model-value"]),s(e(P),{label:"Description",error:e(t).errors.description,"model-value":e(t).description,"onUpdate:modelValue":o[2]||(o[2]=i=>e(t).description=i)},null,8,["error","model-value"]),u("div",Q,[u("div",null,[s(e(F),{class:"mb-1"},{default:d(()=>o[4]||(o[4]=[y("Operations:")])),_:1,__:[4]})]),u("div",W,[(n(!0),f(k,null,L(e(t).operations,(i,p)=>(n(),f("div",{key:i.key,class:"space-y-1"},[(n(),b(e(M),{key:i.key,plants:r.plants,"total-selected":e(t).operations.length,"curr-index":p,"model-value":e(t).operations[p],"onUpdate:modelValue":h=>e(t).operations[p]=h,onRemove:S},null,8,["plants","total-selected","curr-index","model-value","onUpdate:modelValue"]))]))),128))]),u("div",X,[s(e(A),{type:"button",class:"cursor-pointer",variant:"outline",onClick:N},{default:d(()=>[s(e(J)),o[5]||(o[5]=y(" Add Operation"))]),_:1,__:[5]})])]),e(t).status!==void 0?(n(),b(e(I),{key:0,label:U.value,error:e(t).errors.status,"model-value":e(t).status,"onUpdate:modelValue":o[3]||(o[3]=i=>e(t).status=i)},null,8,["label","error","model-value"])):B("",!0),s(e(T),{type:"submit",disabled:e(t).processing,label:"Update",loading:e(t).processing},null,8,["disabled","loading"])]),_:1},8,["title"])],32)]),_:1})]),_:1},8,["breadcrumbs"])],64))}});export{ge as default};
