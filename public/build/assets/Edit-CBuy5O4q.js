import{d as M,A as S,c as v,x as E,j as b,a as c,o as f,e as l,u as e,g as N,w as m,b as d,f as B,q as y,F as g,v as L}from"./app-CAzhD4MS.js";import{L as A}from"./index-Dd2hs5Mb.js";import{_ as k,a as D}from"./FormInput.vue_vue_type_script_setup_true_lang-1-saX_o4.js";import{_ as P}from"./Label.vue_vue_type_script_setup_true_lang-B3UMq8-c.js";import{_ as T}from"./FormSwitch.vue_vue_type_script_setup_true_lang-C5rfxdae.js";import{_ as j}from"./FormTextarea.vue_vue_type_script_setup_true_lang-CM8tMCLv.js";import{_ as F}from"./index-ChYXgvIw.js";import{u as I,S as O,a as R,_ as z,P as G}from"./index-BqgeIhE0.js";import{u as H,_ as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-DOplwsms.js";import{_ as K}from"./AppMainLayout.vue_vue_type_script_setup_true_lang-C6Io95zC.js";import{s as Q}from"./slug-xwoAxeGq.js";import"./useForwardExpose-BdSUi2Nz.js";import"./Switch.vue_vue_type_script_setup_true_lang-DZ5E-AOu.js";import"./RovingFocusGroup-BLXb9mkX.js";import"./useFormControl-gi-vNKXZ.js";import"./VisuallyHiddenInput-CF-N6lhI.js";import"./FormSelect.vue_vue_type_script_setup_true_lang-B3hXB2UX.js";import"./Select.vue_vue_type_script_setup_true_lang-D3Idrs20.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-CmF6mgdh.js";import"./check-tZQ839qP.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DHN0jYIP.js";const W={class:"space-y-3"},X={class:"space-y-3"},Y={class:"space-y-3"},Z={class:"flex items-center justify-center"},Ve=M({layout:K,__name:"Edit",props:{product:{},bom:{},materials:{},options:{}},setup(V){const s=V,{tenant:r}=H(),{uuid:n}=I(),$=[{title:"Dashboard",href:route("dashboard",{tenant:(r==null?void 0:r.id)||""})},{title:"Products",href:route("products.index",{tenant:(r==null?void 0:r.id)||""})},{title:s.product.name,href:"#"},{title:"Boms",href:route("products.boms.index",{tenant:(r==null?void 0:r.id)||"",product:s.product.id})},{title:s.bom.name,href:"#"},{title:"Edit",href:route("products.boms.edit",{tenant:(r==null?void 0:r.id)||"",product:s.product.id,bom:s.bom.id})}],_={data:null,quantity:"",unit_type:""},u=S(s.bom.materials.length?s.bom.materials.map(a=>({key:n(),data:a,quantity:+a.pivot.quantity,unit_type:a.pivot.unit_type})):[{..._,key:n()}]),h=v(()=>{var a;return((a=s.options.switch.statuses.find(t=>t.value===o.status))==null?void 0:a.name)??O[R.INACTIVE]}),U=v(()=>s.materials.map(a=>({name:a.name,value:a}))),o=E({name:s.bom.name,code:s.bom.code,description:s.bom.description||"",materials:[],status:s.bom.status.switch??void 0}),x=()=>{u.value=[...u.value,{..._,key:n()}]},q=a=>{u.value=u.value.filter(t=>t.key!==a)},w=()=>o.put(route("products.boms.update",{tenant:(r==null?void 0:r.id)||"",product:s.product.id,bom:s.bom.id}),{preserveScroll:!0,preserveState:!0});return b(u,a=>{o.materials=a.map(t=>{var i;return{key:t.key,id:((i=t.data)==null?void 0:i.id)||"",quantity:t.quantity,unit_type:t.unit_type}})},{immediate:!0,deep:!0}),b(()=>o.name,a=>{o.code=Q(a)}),(a,t)=>(f(),c(g,null,[l(e(N),{title:`Edit ${s.bom.name}`},null,8,["title"]),l(J,{breadcrumbs:$},{default:m(()=>[l(e(A),null,{default:m(()=>[d("div",W,[d("form",{onSubmit:B(w,["prevent"]),class:"space-y-4"},[l(e(k),{label:"Name",error:e(o).errors.name,"model-value":e(o).name,"onUpdate:modelValue":t[0]||(t[0]=i=>e(o).name=i)},null,8,["error","model-value"]),l(e(k),{label:"Code",error:e(o).errors.code,"model-value":e(o).code,"onUpdate:modelValue":t[1]||(t[1]=i=>e(o).code=i)},null,8,["error","model-value"]),l(e(j),{label:"Description",error:e(o).errors.description,"model-value":e(o).description,"onUpdate:modelValue":t[2]||(t[2]=i=>e(o).description=i)},null,8,["error","model-value"]),d("div",X,[d("div",null,[l(e(P),{class:"mb-1"},{default:m(()=>t[4]||(t[4]=[y("Materials:")])),_:1,__:[4]})]),d("div",Y,[(f(!0),c(g,null,L(u.value,(i,p)=>(f(),c("div",{key:i.key,class:"space-y-1"},[l(e(z),{"material-options":U.value,"unit-type-options":a.options.select.unit_types,"total-selected":u.value.length,"model-value":u.value[p],"onUpdate:modelValue":C=>u.value[p]=C,"curr-index":p,onRemove:q},null,8,["material-options","unit-type-options","total-selected","model-value","onUpdate:modelValue","curr-index"])]))),128))]),d("div",Z,[l(e(F),{type:"button",class:"cursor-pointer",variant:"outline",onClick:x},{default:m(()=>[l(e(G)),t[5]||(t[5]=y(" Add Material"))]),_:1,__:[5]})])]),l(e(T),{label:h.value,error:e(o).errors.status,"model-value":e(o).status,"onUpdate:modelValue":t[3]||(t[3]=i=>e(o).status=i)},null,8,["label","error","model-value"]),l(e(D),{type:"submit",label:"Update",disabled:e(o).processing,loading:e(o).processing},null,8,["disabled","loading"])],32)])]),_:1})]),_:1})],64))}});export{Ve as default};
