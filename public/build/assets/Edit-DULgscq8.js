import{d as E,c as f,A as M,x as N,j as v,a as _,o as n,e as l,u as e,g as S,w as d,b as u,f as B,h as L,i as A,q as y,F as k,v as D}from"./app-CNDRhZsa.js";import{_ as P}from"./Card.vue_vue_type_script_setup_true_lang-C69A4px6.js";import{L as T}from"./index-CNdyCodL.js";import{_ as j}from"./FormError.vue_vue_type_script_setup_true_lang-DReupBN5.js";import{_ as F}from"./index-C7TB37iK.js";import{_ as I}from"./Label.vue_vue_type_script_setup_true_lang-D0cXCugs.js";import{_ as $}from"./FormInput.vue_vue_type_script_setup_true_lang-KZHh6xn6.js";import{_ as O}from"./FormSwitch.vue_vue_type_script_setup_true_lang-DX0TSrsu.js";import{_ as R}from"./FormTextarea.vue_vue_type_script_setup_true_lang-BMaI2_OH.js";import{S as z,a as G,_ as H}from"./index-Bx640klm.js";import{u as J,_ as K}from"./AppLayout.vue_vue_type_script_setup_true_lang-Baqwc1jw.js";import{u as Q,P as W}from"./useUuid-DRMRHhi9.js";import{_ as X}from"./AppMainLayout.vue_vue_type_script_setup_true_lang-bMPH4cGV.js";import{s as Y}from"./slug-xwoAxeGq.js";import"./useForwardExpose-CmZWsVZw.js";import"./Input.vue_vue_type_script_setup_true_lang-Cix1lygM.js";import"./Switch.vue_vue_type_script_setup_true_lang-1yrwjS3h.js";import"./RovingFocusGroup-BRR1Qksf.js";import"./useFormControl-DJXEGNct.js";import"./VisuallyHiddenInput-Bm1IQbLU.js";import"./FormCombobox.vue_vue_type_script_setup_true_lang-CGULAQkF.js";import"./check-C-0vCYcc.js";import"./BreadcrumbSeparator.vue_vue_type_script_setup_true_lang-DptM9AXp.js";import"./chevron-down-CW7V5eHw.js";import"./FormSelect.vue_vue_type_script_setup_true_lang-DHgbodZJ.js";import"./Select.vue_vue_type_script_setup_true_lang-DlhtVtDE.js";import"./nullish-CHIgUVhi.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BkLORlxe.js";const Z={class:"space-y-3"},ee={class:"space-y-3"},te={class:"space-y-3"},oe={class:"flex items-center justify-center"},Ne=E({layout:X,__name:"Edit",props:{product:{},bom:{},materials:{},options:{}},setup(g){const s=g,{tenant:r}=J(),{uuid:p}=Q(),V=f(()=>[{title:"Dashboard",href:route("dashboard",{tenant:(r==null?void 0:r.id)||""})},{title:"Products",href:route("products.index",{tenant:(r==null?void 0:r.id)||""})},{title:s.product.name,href:"#"},{title:"Boms",href:route("products.boms.index",{tenant:(r==null?void 0:r.id)||"",product:s.product.id})},{title:s.bom.name,href:"#"},{title:"Edit",href:route("products.boms.edit",{tenant:(r==null?void 0:r.id)||"",product:s.product.id,bom:s.bom.id})}]),b={data:null,quantity:"",unit_type:""},m=M(s.bom.materials.length?s.bom.materials.map(a=>({key:p(),data:a,quantity:+a.pivot.quantity,unit_type:a.pivot.unit_type})):[{...b,key:p()}]),h=f(()=>{var a;return((a=s.options.switch.statuses.find(t=>t.value===o.status))==null?void 0:a.name)??z[G.INACTIVE]}),U=f(()=>s.materials.map(a=>({name:a.name,value:a}))),o=N({name:s.bom.name,code:s.bom.code,description:s.bom.description||"",materials:[],status:s.bom.status.switch??void 0}),C=()=>{m.value=[...m.value,{...b,key:p()}]},q=a=>{m.value=m.value.filter(t=>t.key!==a)},w=()=>o.put(route("products.boms.update",{tenant:(r==null?void 0:r.id)||"",product:s.product.id,bom:s.bom.id}),{preserveScroll:!0,preserveState:!0});return v(m,a=>{o.materials=a.map(t=>{var i;return{key:t.key,id:((i=t.data)==null?void 0:i.id)||"",quantity:t.quantity,unit_type:t.unit_type}})},{immediate:!0,deep:!0}),v(()=>o.name,a=>{o.code=Y(a)}),(a,t)=>(n(),_(k,null,[l(e(S),{title:`Edit ${s.bom.name}`},null,8,["title"]),l(K,{breadcrumbs:V.value},{default:d(()=>[l(e(T),null,{default:d(()=>[u("div",Z,[u("form",{onSubmit:B(w,["prevent"])},[l(e(P),{title:`Edit ${a.bom.name}`},{default:d(()=>[l(e($),{label:"Name",error:e(o).errors.name,"model-value":e(o).name,"onUpdate:modelValue":t[0]||(t[0]=i=>e(o).name=i)},null,8,["error","model-value"]),l(e($),{label:"Code",error:e(o).errors.code,"model-value":e(o).code,"onUpdate:modelValue":t[1]||(t[1]=i=>e(o).code=i)},null,8,["error","model-value"]),l(e(R),{label:"Description",error:e(o).errors.description,"model-value":e(o).description,"onUpdate:modelValue":t[2]||(t[2]=i=>e(o).description=i)},null,8,["error","model-value"]),u("div",ee,[u("div",null,[l(e(I),{class:"mb-1"},{default:d(()=>t[4]||(t[4]=[y("Materials:")])),_:1,__:[4]})]),u("div",te,[(n(!0),_(k,null,D(m.value,(i,c)=>(n(),_("div",{key:i.key,class:"space-y-1"},[l(e(H),{"material-options":U.value,"unit-type-options":a.options.select.unit_types,"total-selected":m.value.length,"model-value":m.value[c],"onUpdate:modelValue":x=>m.value[c]=x,"curr-index":c,onRemove:q},null,8,["material-options","unit-type-options","total-selected","model-value","onUpdate:modelValue","curr-index"])]))),128))]),u("div",oe,[l(e(F),{type:"button",class:"cursor-pointer",variant:"outline",onClick:C},{default:d(()=>[l(e(W)),t[5]||(t[5]=y(" Add Material"))]),_:1,__:[5]})])]),e(o).status!==void 0?(n(),L(e(O),{key:0,label:h.value,error:e(o).errors.status,"model-value":e(o).status,"onUpdate:modelValue":t[3]||(t[3]=i=>e(o).status=i)},null,8,["label","error","model-value"])):A("",!0),l(e(j),{type:"submit",label:"Update",disabled:e(o).processing,loading:e(o).processing},null,8,["disabled","loading"])]),_:1},8,["title"])],32)])]),_:1})]),_:1},8,["breadcrumbs"])],64))}});export{Ne as default};
